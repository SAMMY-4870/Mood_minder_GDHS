{% extends 'base.html' %}
{% block title %}Fitness & Wellness Tracker ¬∑ Happy Quotes{% endblock %}
{% block extra_css %}
<link href="{{ url_for('static', filename='css/pages/games.css') }}" rel="stylesheet">
<style>
.tracker-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.tracker-header {
    text-align: center;
    margin-bottom: 40px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px 20px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

.tracker-header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.tracker-header p {
    font-size: 1.2rem;
    opacity: 0.9;
}

.tracker-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 30px;
    margin-bottom: 40px;
}

.tracker-card {
    background: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border-left: 5px solid #667eea;
}

.tracker-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

.tracker-card h3 {
    color: #333;
    margin-bottom: 20px;
    font-size: 1.4rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.tracker-card .icon {
    font-size: 1.8rem;
}

.progress-circle {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: conic-gradient(#667eea 0deg, #e9ecef 0deg);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 20px;
    position: relative;
}

.progress-circle::before {
    content: '';
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: white;
    position: absolute;
}

.progress-text {
    position: relative;
    z-index: 1;
    text-align: center;
    font-weight: bold;
    color: #333;
}

.progress-value {
    font-size: 1.5rem;
    color: #667eea;
}

.progress-label {
    font-size: 0.9rem;
    color: #666;
}

.input-group {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    align-items: center;
}

.input-group input {
    flex: 1;
    padding: 10px 15px;
    border: 2px solid #e9ecef;
    border-radius: 10px;
    outline: none;
    font-size: 1rem;
}

.input-group input:focus {
    border-color: #667eea;
}

.btn-add {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 10px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
}

.btn-add:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(111, 66, 193, 0.3);
}

.history-list {
    max-height: 200px;
    overflow-y: auto;
    margin-top: 20px;
}

.history-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid #f0f0f0;
}

.history-item:last-child {
    border-bottom: none;
}

.history-date {
    color: #666;
    font-size: 0.9rem;
}

.history-value {
    font-weight: bold;
    color: #667eea;
}

.mood-journal {
    background: #f8f9fa;
    border-radius: 15px;
    padding: 20px;
    margin-top: 20px;
}

.mood-selector {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    flex-wrap: wrap;
}

.mood-btn {
    padding: 8px 16px;
    border: 2px solid #e9ecef;
    background: white;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem;
}

.mood-btn:hover,
.mood-btn.selected {
    border-color: #667eea;
    background: #667eea;
    color: white;
}

.journal-textarea {
    width: 100%;
    min-height: 100px;
    padding: 15px;
    border: 2px solid #e9ecef;
    border-radius: 10px;
    outline: none;
    font-family: inherit;
    resize: vertical;
}

.journal-textarea:focus {
    border-color: #667eea;
}

.stats-summary {
    background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
}

.stats-summary h3 {
    color: #1976d2;
    margin-bottom: 20px;
    text-align: center;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.stat-item {
    background: white;
    padding: 20px;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.stat-value {
    font-size: 2rem;
    font-weight: bold;
    color: #1976d2;
    margin-bottom: 5px;
}

.stat-label {
    color: #666;
    font-size: 0.9rem;
}

.goal-setting {
    background: #fff3e0;
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
}

.goal-setting h3 {
    color: #f57c00;
    margin-bottom: 20px;
    text-align: center;
}

.goal-form {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}

.goal-input {
    padding: 12px 15px;
    border: 2px solid #f57c00;
    border-radius: 10px;
    outline: none;
    font-size: 1rem;
}

.goal-input:focus {
    border-color: #e65100;
    box-shadow: 0 0 0 3px rgba(245, 124, 0, 0.1);
}

.btn-save-goal {
    background: #f57c00;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 10px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
}

.btn-save-goal:hover {
    background: #e65100;
    transform: translateY(-2px);
}

.current-goals {
    margin-top: 20px;
}

.goal-item {
    background: white;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.goal-progress {
    width: 100px;
    height: 8px;
    background: #e9ecef;
    border-radius: 4px;
    overflow: hidden;
}

.goal-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #f57c00, #ff9800);
    transition: width 0.3s ease;
}

@media (max-width: 768px) {
    .tracker-container {
        padding: 10px;
    }
    
    .tracker-header h1 {
        font-size: 2rem;
    }
    
    .tracker-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .mood-selector {
        justify-content: center;
    }
    
    .goal-form {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="tracker-container">
    <div class="tracker-header">
        <h1>üí™ Fitness & Wellness Tracker</h1>
        <p>Track your daily health metrics and build healthy habits</p>
    </div>

    <!-- Stats Summary -->
    <div class="stats-summary">
        <h3>üìä Today's Summary</h3>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value" id="todaySteps">0</div>
                <div class="stat-label">Steps</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="todayWater">0</div>
                <div class="stat-label">Glasses of Water</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="todayMood">üòê</div>
                <div class="stat-label">Current Mood</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="todaySleep">0</div>
                <div class="stat-label">Hours of Sleep</div>
            </div>
        </div>
    </div>

    <!-- Tracker Cards -->
    <div class="tracker-grid">
        <!-- Steps Tracker -->
        <div class="tracker-card">
            <h3><span class="icon">üö∂</span> Steps Tracker</h3>
            <div class="progress-circle" id="stepsProgress">
                <div class="progress-text">
                    <div class="progress-value" id="stepsValue">0</div>
                    <div class="progress-label">/ 10,000</div>
                </div>
            </div>
            <div class="input-group">
                <input type="number" id="stepsInput" placeholder="Enter steps taken" min="0">
                <button class="btn-add" onclick="addSteps()">Add</button>
            </div>
            <div class="history-list" id="stepsHistory"></div>
        </div>

        <!-- Water Intake Tracker -->
        <div class="tracker-card">
            <h3><span class="icon">üíß</span> Water Intake</h3>
            <div class="progress-circle" id="waterProgress">
                <div class="progress-text">
                    <div class="progress-value" id="waterValue">0</div>
                    <div class="progress-label">/ 8 glasses</div>
                </div>
            </div>
            <div class="input-group">
                <input type="number" id="waterInput" placeholder="Glasses of water" min="0" max="20">
                <button class="btn-add" onclick="addWater()">Add</button>
            </div>
            <div class="history-list" id="waterHistory"></div>
        </div>

        <!-- Sleep Tracker -->
        <div class="tracker-card">
            <h3><span class="icon">üò¥</span> Sleep Tracker</h3>
            <div class="progress-circle" id="sleepProgress">
                <div class="progress-text">
                    <div class="progress-value" id="sleepValue">0</div>
                    <div class="progress-label">/ 8 hours</div>
                </div>
            </div>
            <div class="input-group">
                <input type="number" id="sleepInput" placeholder="Hours of sleep" min="0" max="12" step="0.5">
                <button class="btn-add" onclick="addSleep()">Add</button>
            </div>
            <div class="history-list" id="sleepHistory"></div>
        </div>

        <!-- Mood Journal -->
        <div class="tracker-card">
            <h3><span class="icon">üòä</span> Mood Journal</h3>
            <div class="mood-journal">
                <div class="mood-selector">
                    <button class="mood-btn" data-mood="üò¢" onclick="selectMood('sad')">üò¢ Sad</button>
                    <button class="mood-btn" data-mood="üòê" onclick="selectMood('neutral')">üòê Neutral</button>
                    <button class="mood-btn" data-mood="üòä" onclick="selectMood('happy')">üòä Happy</button>
                    <button class="mood-btn" data-mood="üòÑ" onclick="selectMood('excited')">üòÑ Excited</button>
                    <button class="mood-btn" data-mood="üò∞" onclick="selectMood('anxious')">üò∞ Anxious</button>
                    <button class="mood-btn" data-mood="üò¥" onclick="selectMood('tired')">üò¥ Tired</button>
                </div>
                <textarea class="journal-textarea" id="moodJournal" placeholder="How are you feeling today? What's on your mind?"></textarea>
                <div class="input-group" style="margin-top: 15px;">
                    <button class="btn-add" onclick="saveMoodJournal()">Save Journal Entry</button>
                </div>
            </div>
            <div class="history-list" id="moodHistory"></div>
        </div>
    </div>

    <!-- Goal Setting -->
    <div class="goal-setting">
        <h3>üéØ Set Your Goals</h3>
        <div class="goal-form">
            <input type="number" class="goal-input" id="stepsGoal" placeholder="Daily steps goal" min="1000" max="50000">
            <input type="number" class="goal-input" id="waterGoal" placeholder="Daily water glasses goal" min="4" max="20">
            <input type="number" class="goal-input" id="sleepGoal" placeholder="Daily sleep hours goal" min="4" max="12" step="0.5">
            <button class="btn-save-goal" onclick="saveGoals()">Save Goals</button>
        </div>
        <div class="current-goals" id="currentGoals"></div>
    </div>
</div>

<script>
// Global variables
let currentMood = 'neutral';
let todayData = {
    steps: 0,
    water: 0,
    sleep: 0,
    mood: 'neutral'
};

// Initialize the tracker
document.addEventListener('DOMContentLoaded', function() {
    loadTodayData();
    loadGoals();
    updateProgressCircles();
});

// Load today's data from localStorage
function loadTodayData() {
    const today = new Date().toDateString();
    const savedData = localStorage.getItem(`tracker_${today}`);
    
    if (savedData) {
        todayData = JSON.parse(savedData);
    }
    
    updateDisplay();
}

// Save today's data to localStorage
function saveTodayData() {
    const today = new Date().toDateString();
    localStorage.setItem(`tracker_${today}`, JSON.stringify(todayData));
    updateDisplay();
}

// Update display
function updateDisplay() {
    document.getElementById('todaySteps').textContent = todayData.steps.toLocaleString();
    document.getElementById('todayWater').textContent = todayData.water;
    document.getElementById('todayMood').textContent = getMoodEmoji(todayData.mood);
    document.getElementById('todaySleep').textContent = todayData.sleep;
    
    document.getElementById('stepsValue').textContent = todayData.steps.toLocaleString();
    document.getElementById('waterValue').textContent = todayData.water;
    document.getElementById('sleepValue').textContent = todayData.sleep;
    
    updateProgressCircles();
}

// Update progress circles
function updateProgressCircles() {
    const goals = getGoals();
    
    // Steps progress
    const stepsProgress = Math.min((todayData.steps / goals.steps) * 100, 100);
    document.getElementById('stepsProgress').style.background = 
        `conic-gradient(#667eea ${stepsProgress * 3.6}deg, #e9ecef 0deg)`;
    
    // Water progress
    const waterProgress = Math.min((todayData.water / goals.water) * 100, 100);
    document.getElementById('waterProgress').style.background = 
        `conic-gradient(#667eea ${waterProgress * 3.6}deg, #e9ecef 0deg)`;
    
    // Sleep progress
    const sleepProgress = Math.min((todayData.sleep / goals.sleep) * 100, 100);
    document.getElementById('sleepProgress').style.background = 
        `conic-gradient(#667eea ${sleepProgress * 3.6}deg, #e9ecef 0deg)`;
}

// Add steps
function addSteps() {
    const input = document.getElementById('stepsInput');
    const steps = parseInt(input.value);
    
    if (steps && steps > 0) {
        todayData.steps += steps;
        saveTodayData();
        input.value = '';
        addToHistory('steps', steps);
    }
}

// Add water
function addWater() {
    const input = document.getElementById('waterInput');
    const water = parseInt(input.value);
    
    if (water && water > 0) {
        todayData.water += water;
        saveTodayData();
        input.value = '';
        addToHistory('water', water);
    }
}

// Add sleep
function addSleep() {
    const input = document.getElementById('sleepInput');
    const sleep = parseFloat(input.value);
    
    if (sleep && sleep > 0) {
        todayData.sleep = sleep; // Replace, not add
        saveTodayData();
        input.value = '';
        addToHistory('sleep', sleep);
    }
}

// Select mood
function selectMood(mood) {
    currentMood = mood;
    todayData.mood = mood;
    
    // Update button selection
    document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('selected'));
    event.target.classList.add('selected');
    
    saveTodayData();
}

// Save mood journal
function saveMoodJournal() {
    const journalText = document.getElementById('moodJournal').value.trim();
    
    if (journalText) {
        const entry = {
            mood: currentMood,
            text: journalText,
            timestamp: new Date().toLocaleTimeString()
        };
        
        addToHistory('mood', entry);
        document.getElementById('moodJournal').value = '';
    }
}

// Add to history
function addToHistory(type, value) {
    const historyContainer = document.getElementById(`${type}History`);
    const historyItem = document.createElement('div');
    historyItem.className = 'history-item';
    
    if (type === 'mood') {
        historyItem.innerHTML = `
            <div>
                <div>${getMoodEmoji(value.mood)} ${value.text}</div>
                <div class="history-date">${value.timestamp}</div>
            </div>
        `;
    } else {
        historyItem.innerHTML = `
            <div class="history-date">${new Date().toLocaleTimeString()}</div>
            <div class="history-value">+${value}</div>
        `;
    }
    
    historyContainer.insertBefore(historyItem, historyContainer.firstChild);
    
    // Keep only last 5 items
    while (historyContainer.children.length > 5) {
        historyContainer.removeChild(historyContainer.lastChild);
    }
}

// Get mood emoji
function getMoodEmoji(mood) {
    const moodEmojis = {
        'sad': 'üò¢',
        'neutral': 'üòê',
        'happy': 'üòä',
        'excited': 'üòÑ',
        'anxious': 'üò∞',
        'tired': 'üò¥'
    };
    return moodEmojis[mood] || 'üòê';
}

// Goal management
function getGoals() {
    const savedGoals = localStorage.getItem('tracker_goals');
    return savedGoals ? JSON.parse(savedGoals) : {
        steps: 10000,
        water: 8,
        sleep: 8
    };
}

function saveGoals() {
    const goals = {
        steps: parseInt(document.getElementById('stepsGoal').value) || 10000,
        water: parseInt(document.getElementById('waterGoal').value) || 8,
        sleep: parseFloat(document.getElementById('sleepGoal').value) || 8
    };
    
    localStorage.setItem('tracker_goals', JSON.stringify(goals));
    loadGoals();
    updateProgressCircles();
}

function loadGoals() {
    const goals = getGoals();
    document.getElementById('stepsGoal').value = goals.steps;
    document.getElementById('waterGoal').value = goals.water;
    document.getElementById('sleepGoal').value = goals.sleep;
    
    // Update goal displays
    document.querySelector('#stepsProgress .progress-label').textContent = `/ ${goals.steps.toLocaleString()}`;
    document.querySelector('#waterProgress .progress-label').textContent = `/ ${goals.water} glasses`;
    document.querySelector('#sleepProgress .progress-label').textContent = `/ ${goals.sleep} hours`;
    
    // Show current goals
    const currentGoalsContainer = document.getElementById('currentGoals');
    currentGoalsContainer.innerHTML = `
        <div class="goal-item">
            <div>Daily Steps Goal: ${goals.steps.toLocaleString()}</div>
            <div class="goal-progress">
                <div class="goal-progress-bar" style="width: ${Math.min((todayData.steps / goals.steps) * 100, 100)}%"></div>
            </div>
        </div>
        <div class="goal-item">
            <div>Daily Water Goal: ${goals.water} glasses</div>
            <div class="goal-progress">
                <div class="goal-progress-bar" style="width: ${Math.min((todayData.water / goals.water) * 100, 100)}%"></div>
            </div>
        </div>
        <div class="goal-item">
            <div>Daily Sleep Goal: ${goals.sleep} hours</div>
            <div class="goal-progress">
                <div class="goal-progress-bar" style="width: ${Math.min((todayData.sleep / goals.sleep) * 100, 100)}%"></div>
            </div>
        </div>
    `;
}

// Allow Enter key for inputs
document.getElementById('stepsInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') addSteps();
});

document.getElementById('waterInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') addWater();
});

document.getElementById('sleepInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') addSleep();
});
</script>
{% endblock %}
